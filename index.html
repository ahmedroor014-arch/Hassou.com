<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÑÿπÿ®ÿ© ÿ™ÿπŸÑŸÖ ÿßŸÑŸÑŸáÿ¨ÿßÿ™ ÿßŸÑŸÅÿ±ŸÜÿ≥Ÿäÿ© - Les Accents</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&family=Roboto:wght@400;700&display=swap');

        :root {
            --primary-color: #0084ff;
            --bg-color: #f0f2f5;
            --bot-bubble: #e4e6eb;
            --user-bubble: #0084ff;
            --text-bot: #050505;
            --text-user: #ffffff;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Tajawal', 'Roboto', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        #game-container {
            width: 100%;
            max-width: 450px;
            height: 95vh;
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* Header */
        header {
            background: #fff;
            padding: 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 10;
        }

        header h1 {
            margin: 0;
            font-size: 18px;
            color: #333;
        }

        .score-board {
            font-weight: bold;
            color: var(--primary-color);
            background: #e7f3ff;
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 14px;
        }

        /* Chat Area */
        #chat-box {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            scroll-behavior: smooth;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 15px;
            line-height: 1.5;
            position: relative;
            animation: popIn 0.3s ease-out;
            word-wrap: break-word;
        }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .bot-msg {
            align-self: flex-start;
            background-color: var(--bot-bubble);
            color: var(--text-bot);
            border-bottom-right-radius: 4px; /* RTL flip logic applies visually */
        }
        
        /* Fix for RTL border radius visual logic */
        :dir(rtl) .bot-msg { border-bottom-right-radius: 18px; border-bottom-left-radius: 4px; }
        :dir(rtl) .user-msg { border-bottom-left-radius: 18px; border-bottom-right-radius: 4px; }

        .user-msg {
            align-self: flex-end;
            background-color: var(--user-bubble);
            color: var(--text-user);
        }

        .lesson-card {
            background: #fff8e1;
            border: 1px solid #ffe082;
            padding: 10px;
            border-radius: 8px;
            font-family: 'Roboto', sans-serif; /* French text looks better */
            font-size: 14px;
            white-space: pre-line;
            text-align: left;
            direction: ltr;
        }

        /* Controls Area */
        #controls {
            padding: 15px;
            background: #fff;
            border-top: 1px solid #ddd;
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            min-height: 60px;
        }

        .btn {
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            font-family: 'Tajawal', sans-serif;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .btn:active { transform: scale(0.95); }

        .btn-primary { background: var(--primary-color); color: white; width: 100%; }
        .btn-accent { 
            background: #f0f2f5; 
            color: #333; 
            font-family: 'Roboto', sans-serif; 
            font-size: 20px;
            min-width: 60px;
        }
        .btn-accent:hover { background: #e4e6eb; }
        
        .hidden { display: none !important; }

        /* Typing Indicator */
        .typing {
            align-self: flex-start;
            background: var(--bot-bubble);
            padding: 10px 15px;
            border-radius: 18px;
            display: none;
        }
        .dot {
            height: 8px;
            width: 8px;
            background-color: #999;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
            animation: typing 1.4s infinite ease-in-out both;
        }
        .dot:nth-child(1) { animation-delay: -0.32s; }
        .dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

    </style>
</head>
<body>

<div id="game-container">
    <header>
        <h1>üá´üá∑ ŸÖÿπŸÑŸÖ ÿßŸÑŸÅÿ±ŸÜÿ≥Ÿäÿ©</h1>
        <div class="score-board">ÿßŸÑŸÜŸÇÿßÿ∑: <span id="score">0</span></div>
    </header>

    <div id="chat-box">
        <!-- Messages will appear here -->
        <div class="typing" id="typing-indicator">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        </div>
    </div>

    <div id="controls">
        <!-- Dynamic controls based on game state -->
        <button id="start-btn" class="btn btn-primary" onclick="startGame()">ÿßÿ®ÿØÿ£ ÿßŸÑÿØÿ±ÿ≥</button>
        
        <div id="game-controls" class="hidden" style="display: flex; gap: 10px; width: 100%; justify-content: center;">
            <button class="btn btn-accent" onclick="handleAnswer('√©')">√©</button>
            <button class="btn btn-accent" onclick="handleAnswer('√®')">√®</button>
            <button class="btn btn-accent" onclick="handleAnswer('√™')">√™</button>
        </div>

        <button id="restart-btn" class="btn btn-primary hidden" onclick="resetGame()">ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ‚Üª</button>
    </div>
</div>

<script>
    // Game Data based on user request
    const lessonText = `L'accent est un signe que l'on place sur une voyelle pour en indiquer la prononciation.
    
    1) Accent Aigu (√©)
    Ex: caf√© - √©cole.

    2) Accent Grave (√®)
    Ex: p√®re - m√®re - fr√®re

    3) Accent Circonflexe (√™)
    Ex: for√™t - b√™te - t√™te`;

    const questions = [
        { word: "caf_", answer: "√©", full: "caf√©", type: "Accent Aigu" },
        { word: "p_re", answer: "√®", full: "p√®re", type: "Accent Grave" },
        { word: "for_t", answer: "√™", full: "for√™t", type: "Accent Circonflexe" },
        { word: "_cole", answer: "√©", full: "√©cole", type: "Accent Aigu" },
        { word: "m_re", answer: "√®", full: "m√®re", type: "Accent Grave" },
        { word: "b_te", answer: "√™", full: "b√™te", type: "Accent Circonflexe" },
        { word: "fr_re", answer: "√®", full: "fr√®re", type: "Accent Grave" },
        { word: "t_te", answer: "√™", full: "t√™te", type: "Accent Circonflexe" }
    ];

    // Game State
    let currentQuestionIndex = 0;
    let score = 0;
    let isTyping = false;

    // DOM Elements
    const chatBox = document.getElementById('chat-box');
    const typingIndicator = document.getElementById('typing-indicator');
    const scoreEl = document.getElementById('score');
    const startBtn = document.getElementById('start-btn');
    const gameControls = document.getElementById('game-controls');
    const restartBtn = document.getElementById('restart-btn');

    // Helper: Scroll to bottom
    function scrollToBottom() {
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    // Helper: Add Message
    function addMessage(text, sender, isLesson = false) {
        const div = document.createElement('div');
        div.classList.add('message');
        div.classList.add(sender === 'bot' ? 'bot-msg' : 'user-msg');
        
        if (isLesson) {
            div.innerHTML = `<div class="lesson-card">${text}</div>`;
        } else {
            div.textContent = text;
        }
        
        // Insert before typing indicator
        chatBox.insertBefore(div, typingIndicator);
        scrollToBottom();
    }

    // Bot Thinking Simulation
    function botSpeak(text, delay = 800, isLesson = false, callback = null) {
        isTyping = true;
        typingIndicator.style.display = 'block';
        scrollToBottom();

        setTimeout(() => {
            typingIndicator.style.display = 'none';
            addMessage(text, 'bot', isLesson);
            isTyping = false;
            if (callback) callback();
        }, delay);
    }

    // Start Game Flow
    function startGame() {
        startBtn.classList.add('hidden');
        
        botSpeak("ŸÖÿ±ÿ≠ÿ®ÿßŸã! ÿ£ŸÜÿß ŸÖÿπŸÑŸÖŸÉ ÿßŸÑÿ¢ŸÑŸä. ŸÑŸÜÿ®ÿØÿ£ ÿ®ŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑÿØÿ±ÿ≥ ÿ£ŸàŸÑÿßŸã.", 500, false, () => {
            botSpeak(lessonText, 1500, true, () => {
                botSpeak("ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ≥ÿ™ÿπÿØ ŸÑŸÑÿßÿÆÿ™ÿ®ÿßÿ±ÿü ÿ£ŸÉŸÖŸÑ ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÜÿßŸÇÿµÿ© ÿ®ÿßŸÑŸÄ Accent ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ©.", 1000, false, () => {
                    askQuestion();
                });
            });
        });
    }

    // Ask Question
    function askQuestion() {
        if (currentQuestionIndex >= questions.length) {
            endGame();
            return;
        }

        const q = questions[currentQuestionIndex];
        gameControls.classList.remove('hidden');
        // Show question with delay
        setTimeout(() => {
            botSpeak(`ÿ£ŸÉŸÖŸÑ ÿßŸÑŸÉŸÑŸÖÿ©:  ${q.word}`, 600);
        }, 500);
    }

    // Handle User Input
    function handleAnswer(accent) {
        if (isTyping) return; // Prevent clicking while bot is talking

        // User message
        addMessage(accent, 'user');
        gameControls.classList.add('hidden'); // Hide buttons while processing

        const q = questions[currentQuestionIndex];
        
        if (accent === q.answer) {
            score += 10;
            scoreEl.textContent = score;
            botSpeak(`‚úÖ ÿ£ÿ≠ÿ≥ŸÜÿ™! ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿµÿ≠Ÿäÿ≠ÿ©: ${q.full}`, 600, false, () => {
                nextStep();
            });
        } else {
            botSpeak(`‚ùå ÿÆÿ∑ÿ£. ÿßŸÑÿµÿ≠Ÿäÿ≠ ŸáŸà (${q.answer}) ŸÅŸä ŸÉŸÑŸÖÿ© ${q.full}.`, 800, false, () => {
                nextStep();
            });
        }
    }

    function nextStep() {
        currentQuestionIndex++;
        askQuestion();
    }

    // End Game
    function endGame() {
        let feedback = "";
        if (score === questions.length * 10) feedback = "ŸÖŸÖÿ™ÿßÿ≤! ÿπŸÑÿßŸÖÿ© ŸÉÿßŸÖŸÑÿ© üèÜ";
        else if (score > (questions.length * 10) / 2) feedback = "ÿ¨ŸäÿØ ÿ¨ÿØÿßŸã! üëç";
        else feedback = "ÿ™ÿ≠ÿ™ÿßÿ¨ ŸÑŸÖÿ≤ŸäÿØ ŸÖŸÜ ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ© üìö";

        botSpeak(`ÿßŸÜÿ™ŸáŸâ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±! ŸÜÿ™Ÿäÿ¨ÿ™ŸÉ ŸáŸä ${score} ŸÖŸÜ ${questions.length * 10}.\n${feedback}`, 1000, false, () => {
            restartBtn.classList.remove('hidden');
        });
    }

    // Restart
    function resetGame() {
        chatBox.innerHTML = ''; // Clear chat
        chatBox.appendChild(typingIndicator); // Add typing indicator back
        
        currentQuestionIndex = 0;
        score = 0;
        scoreEl.textContent = '0';
        
        restartBtn.classList.add('hidden');
        gameControls.classList.add('hidden');
        
        // Start directly with quiz or ask if they want lesson again? 
        // Let's start quiz directly to be faster
        botSpeak("ÿ£ŸáŸÑÿßŸã ÿ®ŸÉ ŸÖÿ¨ÿØÿØÿßŸã! ŸÑŸÜÿ®ÿØÿ£ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ± ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.", 500, false, () => {
             askQuestion();
        });
    }

</script>
</body>
</html>
        
       
